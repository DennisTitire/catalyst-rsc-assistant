
<!DOCTYPE html>
<html>
<head>
  <title>Teams RSC Token Test</title>
  <script src="https://res.cdn.office.net/teams-js/2.0.1/js/MicrosoftTeams.min.js"></script>
</head>
<body>
  <h2>Teams RSC Token Test</h2>
  <button onclick="getToken()">Get Graph Token</button>
  <pre id="output"></pre>

  <script>
    microsoftTeams.app.initialize().then(() => {
      document.getElementById("output").textContent = "App initialized in Teams context.";
    }).catch(err => {
      document.getElementById("output").textContent = "Initialization error: " + err;
    });

    function getToken() {
      microsoftTeams.authentication.getAuthToken({
        successCallback: (token) => {
          document.getElementById("output").textContent = "Token acquired:\n" + token;
        },
        failureCallback: (error) => {
          document.getElementById("output").textContent = "Error getting token:\n" + error;
        }
      });
    }
  </script>
</body>
</html>
